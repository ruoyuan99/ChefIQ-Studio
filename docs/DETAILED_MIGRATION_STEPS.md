# 📱 Chef iQ 数据迁移详细步骤指导

## 🎯 目标
将AsyncStorage中的本地数据迁移到Supabase云端数据库

## 📋 准备工作检查清单

### ✅ 环境准备
- [ ] 应用已启动（端口8083）
- [ ] 网络连接正常
- [ ] 已安装Expo Go应用（手机端）

### ✅ 数据准备
- [ ] AsyncStorage中有需要迁移的数据
- [ ] 数据包括：菜谱、收藏、评论等

---

## 🚀 详细迁移步骤

### 第一步：启动应用

#### 方法1：通过浏览器访问（推荐）
1. 打开浏览器
2. 访问：`http://localhost:8083`
3. 等待页面加载完成
4. 您会看到Expo开发工具界面

#### 方法2：通过手机扫描二维码
1. 在手机上下载并打开Expo Go应用
2. 扫描浏览器中显示的二维码
3. 等待应用加载

### 第二步：登录应用

#### 2.1 进入登录页面
1. 应用启动后，您会看到登录界面
2. 如果已有账户，直接登录
3. 如果没有账户，需要先注册

#### 2.2 注册新账户（如果没有账户）
1. 点击 "注册" 或 "Sign Up" 按钮
2. 填写注册信息：
   - **姓名**：输入您的姓名
   - **邮箱**：输入有效的邮箱地址
   - **密码**：设置密码（至少6位）
   - **确认密码**：再次输入密码
3. 点击 "创建账户" 按钮
4. 等待注册成功提示

#### 2.3 登录账户
1. 在登录页面输入：
   - **邮箱**：您注册时使用的邮箱
   - **密码**：您设置的密码
2. 点击 "登录" 按钮
3. 等待登录成功提示

### 第三步：进入数据迁移页面

#### 3.1 导航到Profile页面
1. 登录成功后，您会看到主页面
2. 点击底部导航栏的 **"Profile"** 标签
3. 进入个人资料页面

#### 3.2 找到数据迁移选项
1. 在Profile页面中，向下滚动
2. 找到菜单列表
3. 点击 **"Data Migration"** 选项
4. 进入数据迁移页面

### 第四步：检查迁移状态

#### 4.1 查看用户状态
在数据迁移页面顶部，您会看到：
- **用户状态**：应该显示 "已登录: [您的邮箱]"
- 如果显示 "未登录"，请返回登录页面重新登录

#### 4.2 查看数据概览
页面会显示AsyncStorage中的数据统计：
- **菜谱数量**：显示本地存储的菜谱数量
- **收藏数量**：显示收藏的菜谱数量
- **评论数量**：显示评论数量
- **其他数据**：用户数据、社交统计等

#### 4.3 查看迁移状态
- **迁移状态**：显示 "未迁移" 或 "已迁移"
- 如果显示 "已迁移"，说明数据已经迁移过了

### 第五步：开始数据迁移

#### 5.1 确认迁移条件
确保以下条件都满足：
- ✅ 用户状态显示 "已登录"
- ✅ 数据概览显示有数据需要迁移
- ✅ 迁移状态显示 "未迁移"

#### 5.2 点击开始迁移
1. 点击页面底部的 **"开始迁移"** 按钮
2. 系统会弹出确认对话框
3. 阅读确认信息，了解将要迁移的数据类型
4. 点击 **"确认迁移"** 按钮

#### 5.3 观察迁移进度
迁移过程中，您会看到：
- **迁移进度**：实时显示当前迁移步骤
- **进度指示器**：旋转的加载图标
- **状态信息**：如 "正在迁移用户数据..."、"正在迁移菜谱数据..." 等

### 第六步：等待迁移完成

#### 6.1 迁移过程
迁移会按以下顺序进行：
1. **检查用户认证**：验证登录状态
2. **迁移用户数据**：用户信息、头像等
3. **迁移菜谱数据**：菜谱基本信息
4. **迁移食材和步骤**：每个菜谱的详细内容
5. **迁移收藏和评论**：用户互动数据
6. **完成迁移**：最终确认

#### 6.2 等待时间
- 迁移时间取决于数据量
- 通常需要30秒到2分钟
- 请保持网络连接稳定

### 第七步：查看迁移结果

#### 7.1 成功迁移
如果迁移成功，您会看到：
- **成功提示**：弹出 "迁移成功" 对话框
- **迁移结果**：显示迁移的详细信息
- **状态更新**：迁移状态变为 "已迁移"
- **时间记录**：显示迁移完成时间

#### 7.2 迁移失败
如果迁移失败，您会看到：
- **错误提示**：弹出 "迁移失败" 对话框
- **错误信息**：具体的错误原因
- **解决建议**：根据错误类型提供解决方案

### 第八步：验证迁移结果

#### 8.1 在应用中验证
1. 返回主页面
2. 查看菜谱列表是否正常显示
3. 检查收藏页面是否有数据
4. 查看评论功能是否正常

#### 8.2 检查数据完整性
1. 打开一个菜谱详情页
2. 确认食材和步骤都正确显示
3. 检查图片是否正常加载
4. 验证社交功能（点赞、收藏等）

### 第九步：清理旧数据（可选）

#### 9.1 确认迁移成功
在清理之前，请确认：
- ✅ 迁移状态显示 "已迁移"
- ✅ 应用中的数据正常显示
- ✅ 所有功能都正常工作

#### 9.2 清理AsyncStorage
1. 在数据迁移页面底部
2. 点击 **"清理AsyncStorage"** 按钮
3. 确认清理操作
4. 等待清理完成

---

## 🔧 故障排除

### 问题1：无法访问应用
**症状**：浏览器无法打开 `http://localhost:8083`
**解决方案**：
1. 检查终端是否显示 "Waiting on http://localhost:8083"
2. 尝试刷新浏览器页面
3. 检查防火墙设置

### 问题2：登录失败
**症状**：输入正确信息后仍无法登录
**解决方案**：
1. 检查邮箱格式是否正确
2. 确认密码输入正确
3. 尝试重新注册账户

### 问题3：显示"未登录"
**症状**：数据迁移页面显示用户未登录
**解决方案**：
1. 返回登录页面重新登录
2. 确认登录成功后再进入迁移页面

### 问题4：显示"没有数据"
**症状**：数据概览显示没有数据需要迁移
**解决方案**：
1. 确认AsyncStorage中确实有数据
2. 检查数据格式是否正确
3. 尝试重新启动应用

### 问题5：迁移失败
**症状**：迁移过程中出现错误
**解决方案**：
1. 检查网络连接
2. 确认用户登录状态
3. 查看具体错误信息
4. 尝试重新迁移

### 问题6：部分数据丢失
**症状**：迁移后部分数据不显示
**解决方案**：
1. 检查原始数据格式
2. 查看迁移结果详情
3. 尝试重新迁移特定数据

---

## 📞 获取帮助

如果在迁移过程中遇到问题：

1. **查看错误信息**：仔细阅读错误提示
2. **检查网络连接**：确保网络稳定
3. **重新尝试**：按照步骤重新操作
4. **联系支持**：提供具体的错误信息

---

## ✅ 迁移完成检查清单

- [ ] 用户成功登录
- [ ] 进入数据迁移页面
- [ ] 查看数据概览
- [ ] 开始迁移过程
- [ ] 等待迁移完成
- [ ] 查看迁移结果
- [ ] 验证数据完整性
- [ ] 清理旧数据（可选）

**恭喜！您的数据已成功迁移到云端！** 🎉
